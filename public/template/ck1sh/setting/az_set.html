{include file='ck1sh/_partials/head_inc.html'}
<body>
  <div class="wrap">
    <ul class="breadcrumb" style="background-color: transparent;">
      <li><a href="http://demo.chukou1.cn/Client/Home/Home.aspx">首页</a>&nbsp;<span class="divider">/</span></li>
      <li><a href="?r=oms/home">Selling Helper</a>&nbsp;<span class="divider">/</span></li>
      <li><a href="?r=oms/shorder/normal&platform={$platform}">{$platformName}</a>&nbsp;<span class="divider">/</span></li>
      <li class="active">设置</li>
    </ul>
    <!-- 基本参数设置 start-->
    <div class="setBox" style="padding:15px;">
      <h3>基本参数设置</h3>
      <div class="setBoxBody">
        <form id="nosubmit_form" onSubmit="return false;">
          <p> <span>订单的获取方式：</span>
            <label>
              <input name="ORDER_DOWN_STYLE" type="radio" value="100"{if $data.1 eq 100} checked{/if}>
              自动同步</label>
            <label>
              <input name="ORDER_DOWN_STYLE" type="radio" value="101"{if $data.1 eq 101} checked{/if}>
              手动上传</label>
          </p>
          <p> <span>上传挂号方式：</span>
            <label>
              <input name="TRACKING_UPLOAD_STYLE" type="radio" value="300"{if $data.3 eq 300} checked{/if}>
              自动上传挂号到<b>亚马逊</b></label>
            <label>
              <input name="TRACKING_UPLOAD_STYLE" type="radio" value="301"{if $data.3 eq 301} checked{/if}>
              手动上传<a href="http://www.chukou1.com/doc/sellinghelper/UploadAmazonTrackingFilesForCK1.pdf" target="_blank">上传挂号帮助»</a></label>
          </p>
          <p> <span>SKU：</span>
            <select name="SKU_MATCH_RULE">
              <option value="401"{if $data.4 eq 401} selected{/if}>等于商品编码</option>
              <option value="402"{if $data.4 eq 402} selected{/if}>是商品编码的一部分（使用分隔符）</option>
              <option value="403"{if $data.4 eq 403} selected{/if}>是商品编码的一部分（前几位字符）</option>
            </select>
            <b class="help-inline">*</b> <a href="http://www.chukou1.com/doc/sellinghelper/SKUInfoMapping(AliExpress).pdf" target="_blank">SKU相关说明»</a> </p>
          <!-- skupart这一部分根据SKU选择框来决定显示或者隐藏 -->
          <p id='skupart1' style="display:none;"><span>分隔符号：</span>
            <input name="SKU_SEPARATOR" type="text" value="{$data.5}" maxlength="16">
            <b class="help-inline">* 截取第一个分隔符之前的部分</b></p>
          <p id='skupart2' style="display:none;"><span>SKU长度：</span>
            <input name="SKU_PREV_LENGTH" type="text" value="{$data.6}" maxlength="16">
            <b class="help-inline">* 截取固定长度的前面部分</b></p>
          <p class='skuJudge' style="margin-left:150px;margin-top:-20px;color:red;display:none;">提示行-需要时显示：</p>
          <p> <span>直发订单自定义标识：</span>
            <label>
              <input name="EXP_CUSTOM_MARKING" type="radio" value='702'{if $data.7 eq 702} checked{/if}>
              订单号</label>
            <label>
              <input name="EXP_CUSTOM_MARKING" type="radio" value='703'{if $data.7 eq 703} checked{/if}>
              SKU</label>
            <label>
              <input name="EXP_CUSTOM_MARKING" type="radio" value='704'{if $data.7 eq 704} checked{/if}>
              订单号+SKU</label>
            <label>
              <input name="EXP_CUSTOM_MARKING" type="radio" value='705'{if $data.7 eq 705} checked{/if}>
              订单号+SKU+Seller</label>
          </p>
          <p> <span></span>
            <label>
              <input name="EXP_CUSTOM_MARKING" type="radio" value='706'{if $data.7 eq 706} checked{/if}>
              申报名称</label>
            <label>
              <input name="EXP_CUSTOM_MARKING" type="radio" value='707'{if $data.7 eq 707} checked{/if}>
              订单号+申报名称</label>
            <label>
              <input name="EXP_CUSTOM_MARKING" type="radio" value='708'{if $data.7 eq 708} checked{/if}>
              订单号+申报名称+Seller</label>
          </p>
          <p><span>确认发货：</span>
            <label>
              <input name="SHIPPING_MARK_STYLE" type="checkbox" value='200'{if $data.2 eq 200} checked{/if}>
              确认发货后系统自动在亚马逊平台上确认发货 </label>
          </p>
          <div class="SetFooter">
            <input name="btn_save" type="button" class="btn btn-primary" value="保存" id="btn_save">
             <a href="?r=oms/shorder/normal&platform=101">返回上一级</a>
          </div>
        </form>
      </div>
    </div>
    <!-- 基本参数设置 end-->
  </div>
  {literal}
  <script>
    "use strict";
    require(['util'], function(util){
        $(function(e) {
        	$("#nosubmit_form").submit(function(e) {
                e.preventDefault();
            });

        	$("#btn_back").on('click',function(){
        		history.back();
        	});

        	$("#btn_save").click(function(e) {
        		if($("[name=SKU_MATCH_RULE]").val() == 402){
        			if($("[name=SKU_SEPARATOR]").val() == ''){
        				$("[name=SKU_SEPARATOR]").addClass('redBorder');
        				util.showTips('error', '分隔符号不能为空！');
        				return;
        			}else{
        				$("[name=SKU_SEPARATOR]").removeClass('redBorder');
        			}
        		}
        		if($("[name=SKU_MATCH_RULE]").val() == 403){
        			if(isNaN($("[name=SKU_PREV_LENGTH]").val()) || $("[name=SKU_PREV_LENGTH]").val() == 0){
        				$("[name=SKU_PREV_LENGTH]").addClass('redBorder');
        				util.showTips('error', 'SKU长度必须是数字而且大于0！');
        				return;
        			}else{
        				$("[name=SKU_PREV_LENGTH]").removeClass('redBorder');
        			}
        		}
        		$.post("index.php?r=oms/shaz/AzSaveSetup",$("#nosubmit_form").serialize(),
        		function(data,status){
        			if(status === 'success' && data > 0){
        				util.showTips('success', '保存成功！');
        			}else if(data==0){
        				util.showTips('info', '数据没有改变！');
        			}else{
        				util.showTips('error', '保存失败!');
        			}
        		});
            });

        	$("select[name='SKU_MATCH_RULE']").change(function(e) {
                changeSH();
            });

        	function changeSH(){
        		if($("select[name='SKU_MATCH_RULE']").val()==402){
        			$("#skupart1").show();
        			$("#skupart2").hide();
        		}else if($("select[name='SKU_MATCH_RULE']").val()==403){
        			$("#skupart1").hide();
        			$("#skupart2").show();
        		}else{
        			$("#skupart1,#skupart2").hide();
        		}
        	}
        	changeSH();
        });
    });
  </script>
  {/literal}
</body>
</html>
